<!DOCTYPE html><html lang="en" class="md-theme-default"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><!--[if IE]><link rel="icon" href="/favicon.ico" /><![endif]--><script async="" src="https://www.google-analytics.com/analytics.js"></script><title>Site 项目结构介绍 | Aquariuslt Blog</title><link href="/css/about.f196d9fa.css" rel="prefetch"><link href="/css/detail.550d548d.css" rel="prefetch"><link href="/js/about.4a9bcd9b.js" rel="prefetch"><link href="/js/detail.6420c1aa.js" rel="prefetch"><link href="/css/app.4df1cf9a.css" rel="preload" as="style"><link href="/css/chunk-vendors.9bb7e852.css" rel="preload" as="style"><link href="/js/app.35f821a8.js" rel="preload" as="script"><link href="/js/chunk-vendors.6db92837.js" rel="preload" as="script"><link href="/css/chunk-vendors.9bb7e852.css" rel="stylesheet"><link href="/css/app.4df1cf9a.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="32x32" href="/img/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/icons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#1A73E8"><meta name="apple-mobile-web-app-capable" content="no"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="apple-mobile-web-app-title" content="Aquariuslt Blog"><link rel="apple-touch-icon" href="/img/icons/apple-touch-icon-152x152.png"><link rel="mask-icon" href="/img/icons/safari-pinned-tab.svg" color="#1A73E8"><meta name="msapplication-TileImage" content="/img/icons/msapplication-icon-144x144.png"><meta name="msapplication-TileColor" content="#000000"><link rel="stylesheet" type="text/css" href="/css/detail.550d548d.css"><script charset="utf-8" src="/js/detail.6420c1aa.js"></script><meta data-vue-meta="1" name="google-site-verification" content="s3PYm0fCo0ImPqqXoPLiUb_bFdlYODKw54VGSkcFgyE"><meta data-vue-meta="1" name="google-analytics" content="UA-68904127-1"><meta data-vue-meta="1" name="og:site_name" content="Aquariuslt Blog"><meta data-vue-meta="1" name="og:type" content="website"><meta data-vue-meta="1" name="og:title" content="Site 项目结构介绍"><meta data-vue-meta="1" name="og:description" content="应该说是第一个 Node.js 建站项目. 目的是用于替换 JavaWeb 的后台而且可以在过程中练习一下调节样式的水平.项目本身的结构是从JShelf开始. 是由于公司内部组织了一次 MEAN 的一些入门分享. 分成了几个小组,我们小组根据对 MEAN 的认识魔改了这样一个基本的项目基础结构. 在其原本的结构上.做了做了一些蛋疼的修改大概是根据npm install的提示,更换 lib 的名字或者升级 lib 的版本到最新版. 然后删除了一些没必要的模块.
"><meta data-vue-meta="1" name="og:image" content="./cover.png"><meta data-vue-meta="1" name="og:type" content="article"><script data-vue-meta="1" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://blog.aquariuslt.com","name":"Aquariuslt Blog","position":1},{"@type":"ListItem","item":"https://blog.aquariuslt.com/posts","name":"Posts","position":2},{"@type":"ListItem","item":"https://blog.aquariuslt.com/posts/2016/03/06/site-code-structure","name":"Site 项目结构介绍","position":3}]}</script><script id="embed-disqus" data-timestamp="1572454561991" type="text/javascript" async="" src="//aquariuslt.disqus.com/embed.js"></script><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.953a2bd009935f47a8e815c3ee2bfc5a.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.9ae27258a9490b17fbb3b9cdf530aff0.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.0adc4cfceff8c3ab4259d467d6ea3419.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><script src="https://c.disquscdn.com/next/embed/alfalfalfa.0823c767a3bc925f628afd9bed26c958.js" async="" charset="UTF-8"></script></head><body><div data-v-18dadf06="" id="app"><div data-v-18dadf06="" class="md-app md-app-side-drawer md-layout-row md-waterfall md-fixed md-theme-default"><div data-v-18dadf06="" class="md-drawer md-app-drawer md-theme-default md-left md-temporary"><div data-v-ac1b82fe="" data-v-18dadf06="" class="profile"><div data-v-ac1b82fe="" class="md-card md-theme-default"><div data-v-ac1b82fe="" class="md-card-header"><div data-v-ac1b82fe="" class="md-avatar md-theme-default"><img data-v-ac1b82fe="" src="https://img.aquariuslt.com/social/avator.png" alt="Avatar"></div><div data-v-ac1b82fe="" class="md-title">Aquariuslt</div><div data-v-ac1b82fe="" class="md-subhead">superaquariuslt@gmail.com</div></div></div></div><ul data-v-18dadf06="" class="md-list md-theme-default"><li data-v-18dadf06="" to="/" exact="" class="md-list-item"><a data-v-18dadf06="" href="/" class="md-list-item-router md-list-item-container md-button-clean" mdripple="true"><div class="md-list-item-content md-ripple"><i data-v-18dadf06="" class="mdi mdi-24px mdi-home"></i><span data-v-18dadf06="" class="md-list-item-text">Home</span> </div></a></li><li data-v-18dadf06="" to="/categories" exact="" class="md-list-item"><a data-v-18dadf06="" href="/categories" class="md-list-item-router md-list-item-container md-button-clean" mdripple="true"><div class="md-list-item-content md-ripple"><i data-v-18dadf06="" class="mdi mdi-24px mdi-shape"></i><span data-v-18dadf06="" class="md-list-item-text">Categories</span> </div></a></li><li data-v-18dadf06="" to="/tags" exact="" class="md-list-item"><a data-v-18dadf06="" href="/tags" class="md-list-item-router md-list-item-container md-button-clean" mdripple="true"><div class="md-list-item-content md-ripple"><i data-v-18dadf06="" class="mdi mdi-24px mdi-bookmark"></i><span data-v-18dadf06="" class="md-list-item-text">Tags</span> </div></a></li></ul> </div>  <main class="md-app-container md-flex md-layout-column md-theme-default md-scrollbar" style="padding-left: 0px;"><div data-v-18dadf06="" class="md-toolbar md-app-toolbar md-primary md-theme-default md-elevation-2 md-no-elevation" md-elevation="2" style="top: 0px;"><div data-v-18dadf06="" class="md-toolbar-row"><button data-v-18dadf06="" type="button" class="md-button md-icon-button md-theme-default" aria-label="menu"><div class="md-ripple"><div class="md-button-content"><i data-v-18dadf06="" class="mdi mdi-24px mdi-menu"></i></div> </div></button><span data-v-18dadf06="" class="md-title app-title">Site 项目结构介绍 | Aquariuslt Blog</span></div></div> <div class="md-app-scroller md-layout-column md-flex md-theme-default md-scrollbar"><div data-v-18dadf06="" class="md-content md-app-content md-flex md-theme-default"><div data-v-590589f6="" data-v-18dadf06="" class="detail md-layout md-gutter md-alignment-top-center"><div data-v-46cb6cfe="" data-v-590589f6="" class="md-layout md-gutter md-alignment-top-center md-layout-item md-size-100"><div data-v-46cb6cfe="" class="breadcrumbs"><span data-v-46cb6cfe=""><a data-v-46cb6cfe="" href="/" class="breadcrumbs-item"> Aquariuslt Blog</a><span data-v-46cb6cfe="">&gt;</span></span><span data-v-46cb6cfe=""><a data-v-46cb6cfe="" href="/posts" class="breadcrumbs-item"> Posts</a><span data-v-46cb6cfe="">&gt;</span></span><span data-v-46cb6cfe=""><a data-v-46cb6cfe="" href="/posts/2016/03/06/site-code-structure" class="breadcrumbs-item router-link-exact-active router-link-active"> Site 项目结构介绍</a><!----></span></div></div><div data-v-48e13d92="" data-v-590589f6="" class="md-layout md-gutter md-alignment-top-center md-layout-item md-size-100"><div data-v-48e13d92="" class="md-card article-detail md-theme-default"><div data-v-48e13d92="" class="md-card-media article-cover"><img data-v-48e13d92="" src="/posts/2016/03/06/site-code-structure/cover.png" alt="cover"></div><div data-v-48e13d92="" class="md-card-content markdown-body"><h1>Site 项目结构介绍</h1>
<h2>Background</h2>
<p>应该说是第一个 Node.js 建站项目. 目的是用于替换 JavaWeb 的后台而且可以在过程中练习一下调节样式的水平.</p>
<p>项目本身的结构是从<a href="https://github.com/Dantemo/JShelf">JShelf</a>开始. 是由于公司内部组织了一次 MEAN 的一些入门分享. 分成了几个小组,我们小组根据对 MEAN 的认识魔改了这样一个基本的项目基础结构. 在其原本的结构上.做了做了一些蛋疼的修改大概是根据<code>npm install</code>的提示,更换 lib 的名字或者升级 lib 的版本到最新版. 然后删除了一些没必要的模块.</p>
<p>目前已经在我的 VPS 上运行,<a href="https://aquariuslt.com">主站</a>是目前的效果.</p>
<h2>Agenda</h2>
<p>整个项目的结构从以下几个部分开始介绍,但是在过程中会交错穿插一点互相引用的地方.</p>
<ul>
<li>运作思路</li>
<li>代码结构</li>
<li>构建过程</li>
<li>运行准备</li>
</ul>
<h2>Thought</h2>
<p>从 Coding 的角度出发,<code>Node.js</code>作为服务器端语言的优势之一就是不需要编译,直接重启 node 进程即可. 而前端代码呢,在开发的时候,我们希望能够达到所见即所得的方式,即 html+样式的修改能够直接呈现在页面上. 在生产环境的时候,为了加快访问速度,对前端代码进行必要的打包,压缩,混淆等操作.</p>
<p>作为单页应用的一部分,希望能够进行自动引入所需的 js 文件,不需要手动维护首页 html 里面的直接饮用</p>
<p>按照这个想法,理想中的前端开发顺序希望是这样:</p>
<ul>
<li>
<p>开发环境</p>
<blockquote>
<ol>
<li>以符合<code>RequireJS规范</code>编写前端代码</li>
<li>前端的 html,css,js 代码一旦有改动,且通过了 IDE 的 jshint 与 html 格式化检查,立刻热替换到所展示的页面中</li>
</ol>
</blockquote>
</li>
<li>
<p>生产环境</p>
<blockquote>
<ol>
<li>将写好的前端代码打包</li>
<li>服务器将前端的首页,以及打包后的 js,css 文件,释放出一个可访问的 url 作为前端资源文件的全部</li>
</ol>
</blockquote>
</li>
</ul>
<h2>Code Structure</h2>
<h3>Folder TreeView</h3>
<p>首先我们来看一下项目的目录结构:</p>
<blockquote>
<p>这是一个遍历到子文件夹 5 层的项目结构目录. 已经去除 <code>node_modules</code>文件夹和 IDE 的文件夹</p>
</blockquote>
<pre><code>├── dist
│&nbsp;&nbsp; ├── build
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bundle.css
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bundle.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fonts
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── glyphicons-halflings-regular.eot
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── glyphicons-halflings-regular.svg
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── glyphicons-halflings-regular.ttf
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── glyphicons-halflings-regular.woff
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── glyphicons-halflings-regular.woff2
│&nbsp;&nbsp; │&nbsp;&nbsp; └── index.html
│&nbsp;&nbsp; └── tmp
│&nbsp;&nbsp;     └── templates.js
├── gulp
│&nbsp;&nbsp; ├── client
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── assets.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── browserify.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── clean.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── default.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fonts.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── images.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── core.store.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── minify.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── serve.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── styles.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── templates.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── watch.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── watchify.js
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── webpack-watch.js
│&nbsp;&nbsp; │&nbsp;&nbsp; └── webpack.js
│&nbsp;&nbsp; ├── config.js
│&nbsp;&nbsp; ├── core.store.js
│&nbsp;&nbsp; └── server
│&nbsp;&nbsp;     ├── core.store.js
│&nbsp;&nbsp;     └── server.js
├── gulpfile.js
├── node_modules
├── package.json
├── readme.md
├── server.js
├── src
│&nbsp;&nbsp; ├── client
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── home
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── controllers
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── activities.controller.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── header.controller.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── home.controller.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── picture.slide.controller.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── filters
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── activity.array.filter.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── activity.publish.filter.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── core.store.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── routes
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── home.routes.js
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── styles
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── about.css
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── angular-ui-bootstrap.css
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── bootstrap-theme.css
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── bootstrap.css
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── common.css
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── home.css
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── views
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── home.about.html
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── home.footer.html
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── home.header.html
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     └── home.index.html
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── index.html
│&nbsp;&nbsp; │&nbsp;&nbsp; └── core.store.js
│&nbsp;&nbsp; └── server
│&nbsp;&nbsp;     └── home
│&nbsp;&nbsp;         ├── config
│&nbsp;&nbsp;         │&nbsp;&nbsp; └── activities.config.js
│&nbsp;&nbsp;         ├── controllers
│&nbsp;&nbsp;         │&nbsp;&nbsp; └── activities.controller.js
│&nbsp;&nbsp;         └── routes
│&nbsp;&nbsp;             └── home.routes.js
└── tree.txt

2381 directories, 10428 files

</code></pre>
<h3>Review with Java-Web Project</h3>
<p>回想一下使用 maven 进行依赖管理的简单 Java Web 项目. 大致是以下一种目录:</p>
<pre><code>├── pom.xml
├── src
│&nbsp;&nbsp; ├── main
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── java
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── com
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     └── aquariuslt
│&nbsp;&nbsp; │&nbsp;&nbsp; └── webapp
│&nbsp;&nbsp; │&nbsp;&nbsp;     ├── WEB-INF
│&nbsp;&nbsp; │&nbsp;&nbsp;     │&nbsp;&nbsp; ├── mvc-dispatcher-servlet.xml
│&nbsp;&nbsp; │&nbsp;&nbsp;     │&nbsp;&nbsp; └── web.xml
│&nbsp;&nbsp; │&nbsp;&nbsp;     ├── booking-create.html
│&nbsp;&nbsp; │&nbsp;&nbsp;     └── js
│&nbsp;&nbsp; │&nbsp;&nbsp;         ├── booking
│&nbsp;&nbsp; │&nbsp;&nbsp;         └── extjs
│&nbsp;&nbsp; └── test
│&nbsp;&nbsp;     └── java
│&nbsp;&nbsp;         └── com
│&nbsp;&nbsp;             ├── aquariuslt
│&nbsp;&nbsp;             └── springapp
└── target
    ├── ITA-BookingUI
    │&nbsp;&nbsp; ├── META-INF
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST.MF
    │&nbsp;&nbsp; ├── WEB-INF
    │&nbsp;&nbsp; │&nbsp;&nbsp; ├── classes
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── com
    │&nbsp;&nbsp; │&nbsp;&nbsp; ├── lib
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── aopalliance-1.0.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── commons-logging-1.2.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── freemarker-2.3.23.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── jackson-core-asl-1.9.13.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── jackson-mapper-asl-1.9.13.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── servlet-api-2.5.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-aop-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-beans-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-context-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-context-support-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-core-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-expression-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-web-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── spring-webmvc-4.2.0.RELEASE.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── tomcat-servlet-api-7.0.63.jar
    │&nbsp;&nbsp; │&nbsp;&nbsp; ├── mvc-dispatcher-servlet.xml
    │&nbsp;&nbsp; │&nbsp;&nbsp; └── web.xml
    │&nbsp;&nbsp; ├── booking-create.html
    │&nbsp;&nbsp; └── js
    │&nbsp;&nbsp;     ├── booking
    │&nbsp;&nbsp;     │&nbsp;&nbsp; ├── BookingCreateApp.js
    │&nbsp;&nbsp;     │&nbsp;&nbsp; ├── controller
    │&nbsp;&nbsp;     │&nbsp;&nbsp; └── view
    │&nbsp;&nbsp;     └── extjs
    │&nbsp;&nbsp;         ├── ext-all-debug.js
    │&nbsp;&nbsp;         ├── ext-theme-neptune
    │&nbsp;&nbsp;         └── resources
    ├── ITA-BookingUI.war
    ├── classes
    │&nbsp;&nbsp; └── com
    │&nbsp;&nbsp;     └── aquariuslt
    │&nbsp;&nbsp;         └── ita
    ├── generated-sources
    │&nbsp;&nbsp; └── annotations
    ├── generated-test-sources
    │&nbsp;&nbsp; └── test-annotations
    └── test-classes
        └── com
            └── aquariuslt
                └── ita

41 directories, 28 files
</code></pre>
<blockquote>
<p><code>src</code>文件夹作为源代码目录 <code>src-&gt;main-&gt;java</code>下的代码作为后台的代码 <code>src-&gt;main-&gt;webapp</code>作为运行时 web 应用容器的配置,包含了前端的资源文件 <code>pom.xml</code>作为项目的依赖管理,命名选项配置文件 <code>target</code>文件夹则是通过 maven 构建命令编译构建出来的 输出目录</p>
</blockquote>
<h3>Files &amp; Folders</h3>
<h4>package.json</h4>
<p>功能等同<code>pom.xml</code></p>
<h4>src</h4>
<p>源代码文件夹. 其中往下分可以分成前端模块和后端模块两个大部分为了方便分类,将它分成了<code>client</code>,<code>server</code> 源代码的子层级命名方式为<code>module</code>-<code>mvc feature</code>-<code>submodule</code></p>
<h4>gulp</h4>
<p>存放<code>GulpTask</code>的文件夹. 子文件夹又分成<code>client</code>和<code>server</code>的 tasks. 至于使用 Gulp 来进行什么样的构建,在下一部分会说明</p>
<h4>dist</h4>
<p>构建出来的前端输出文件夹.类似于 JavaWeb 里面的 target. 但是仅限前端. 这里存放的是经过打包后的前端资源. 在整个应用启动的时候,将会扫描该文件夹,将其全部作为静态资源暴露出 url.</p>
<h2>GulpTask</h2>
<h3>Gulp</h3>
<h4>What is Gulp</h4>
<p><a href="https://gulpjs.com/">Gulp 官方网站</a> Gulp.js 是一个自动化构建工具，开发者可以使用它在项目开发过程中自动执行常见任务。</p>
<h4>How to Use</h4>
<p>我使用 gulp 来干什么呢? 单从前端运行的过程来说.我使用 Gulp 的 Task 进行下面一个流程. <img src="/posts/2016/03/06/site-code-structure/build-flow.png" alt=""></p>
<h3>Build Flow</h3>
<p>为了达到最终的目的:单页应用输出最终的一个页面.</p>
<pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">ng-app</span>=<span class="hljs-string">"home"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"shortcut icon"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"<a class="vglnk" href="https://avatars3.githubusercontent.com/u/6554061?v=3&amp;s=460" rel="nofollow"><span>https</span><span>://</span><span>avatars3</span><span>.</span><span>githubusercontent</span><span>.</span><span>com</span><span>/</span><span>u</span><span>/</span><span>6554061</span><span>?</span><span>v</span><span>=</span><span>3</span><span>&amp;</span><span>s</span><span>=</span><span>460</span></a>"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Aquariuslt Home<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"bundle.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>
      <span class="hljs-attr">ng-include</span>=<span class="hljs-string">"'home/views/home.header.html'"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar navbar-default navbar-fixed-top navbar-inner"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-header"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ui-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bundle.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">ng-include</span>=<span class="hljs-string">"'home/views/home.footer.html'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"footer"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>我们需要怎么构建出这样一个页面呢? 按照我的 gulp tasks 代码上是这样:</p>
<pre><code class="hljs js"><span class="hljs-comment">//按照以下顺序运行task</span>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV == <span class="hljs-string">'release'</span>) {
  runSequence(
    <span class="hljs-string">'clean'</span>,
    [<span class="hljs-string">'index'</span>, <span class="hljs-string">'styles'</span>, <span class="hljs-string">'images'</span>, <span class="hljs-string">'fonts'</span>, <span class="hljs-string">'assets'</span>, <span class="hljs-string">'templates'</span>],
    <span class="hljs-comment">//'browserify',</span>
    <span class="hljs-string">'webpack'</span>,
    <span class="hljs-string">'minify'</span>,
    <span class="hljs-string">'server'</span>
  );
}
</code></pre>
<p>前面第一个 clean 只是清除 dist 文件夹的任务而已而已.</p>
<p>一开始,<code>index.html</code>只是这样:</p>
<pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">ng-app</span>=<span class="hljs-string">"home"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"shortcut icon"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"<a class="vglnk" href="https://avatars3.githubusercontent.com/u/6554061?v=3&amp;s=460" rel="nofollow"><span>https</span><span>://</span><span>avatars3</span><span>.</span><span>githubusercontent</span><span>.</span><span>com</span><span>/</span><span>u</span><span>/</span><span>6554061</span><span>?</span><span>v</span><span>=</span><span>3</span><span>&amp;</span><span>s</span><span>=</span><span>460</span></a>"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Aquariuslt Home<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-comment">&lt;!--styles--&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>
      <span class="hljs-attr">ng-include</span>=<span class="hljs-string">"'home/views/home.header.html'"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar navbar-default navbar-fixed-top navbar-inner"</span>
    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-header"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ui-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!--scripts--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">ng-include</span>=<span class="hljs-string">"'home/views/home.footer.html'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"footer"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4>index</h4>
<p><code>index</code>这个 task,主要功能是读取构建的一个配置文件<code>config.js</code>获取<code>index.html</code>的路径. 紧接着比较傻逼的将 html 中的</p>
<pre><code class="hljs htmlbars"><span class="xml"><span class="hljs-comment">&lt;!--styles--&gt;</span>
</span></code></pre>
<p>替换成</p>
<pre><code class="hljs htmlbars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"bundle.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
</span></code></pre>
<p>将</p>
<pre><code class="hljs htmlbars"><span class="xml"><span class="hljs-comment">&lt;!--scripts--&gt;</span>
</span></code></pre>
<p>替换成</p>
<pre><code class="hljs htmlbars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bundle.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</span></code></pre>
<p>虽然 css,js 还没有经过打包.但是先替换,存放在 dist 文件夹下.</p>
<h4>styles</h4>
<p>在配置文件<code>config.js</code>里面,需要维护一个 css 文件夹的正则路径.匹配到多个路径下的 css 位置供扫描. css 文件的路径大概是这样子的:</p>
<pre><code>styles: [config.folder.src + '/client/**/styles/*.css'],
</code></pre>
<p>即 src 文件夹下,匹配到 client 下的隔层文件夹里的所有叫<code>styles</code>的子文件夹下的所有 css 文件 <code>styles</code>主要是将扫描出来的所有 css 文件打包在一起,融合成 刚刚替换成的<code>bundle.min.js</code></p>
<h3>images,fonts,assets</h3>
<p>这三个 tasks 功能类似.即也是读取配置文件所维护的一个匹配所有静态资源文件将其放到 dist 下对应的文件夹内.</p>
<h3>templates</h3>
<p>在配置文件<code>config.js</code>,控制将一个负责控制所有视图(views)的路径</p>
<pre><code>templates: config.folder.src + '/client/**/*.html',
</code></pre>
<p><code>templates</code>这个 tasks 主要是扫描所有<code>.html</code>的视图文件,用于生成一些 <code>ngTempalte</code>供 angular 调用 html 模板其实最后这些生成的模板将会合并进 js 中. 大概会变成下面这样:</p>
<pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = angular.module(<span class="hljs-string">'templates'</span>, []).run([
  <span class="hljs-string">'$templateCache'</span>,
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$templateCache</span>) </span>{
    $templateCache.put(
      <span class="hljs-string">'index.html'</span>,
      <span class="hljs-string">'&lt;!DOCTYPE html&gt;\n&lt;html ng-app="home"&gt;\n  &lt;head&gt;\n    &lt;meta charset="utf-8"&gt;\n    ...'</span>
    );
    $templateCache.put(
      <span class="hljs-string">'home/views/home.about.html'</span>,
      <span class="hljs-string">'&lt;div role="main" class="container"&gt;\n  &lt;div class="row"&gt;\n    &lt;...'</span>
    );
    $templateCache.put(
      <span class="hljs-string">'home/views/home.footer.html'</span>,
      <span class="hljs-string">'&lt;div class="container"&gt;\n  &lt;div class="center-block"&gt;\n    &lt;h5&gt;B...'</span>
    );
    $templateCache.put(
      <span class="hljs-string">'home/views/home.header.html'</span>,
      <span class="hljs-string">'&lt;div class="container" ng-controller="headerController"&gt;\n  &lt;div...'</span>
    );
    $templateCache.put(
      <span class="hljs-string">'home/views/home.index.html'</span>,
      <span class="hljs-string">'&lt;div class="container"&gt;\n  &lt;div class="jumbotron"&gt;\n    &lt;div clas...'</span>
    );
  }
]);
</code></pre>
<h3>webpack/browserify</h3>
<p>这两个是现在主流的 js 打包工具.配合自身的一些插件.主要做到能够将以<code>requirejs</code>方式编的方式的代码. 为了方便开发和调试, <code>webpack</code>和<code>browserify</code>都有一个热打包插件:过程都是监听所有 js 源代码的路径.当文件更新的时候,自动在打包一次.部署到运行的服务器上.</p>
<h3>minify</h3>
<p>这个以前叫做 uglify,就是压缩 js 代码,变量名混淆.</p>
</div><div data-v-48e13d92="" class="md-card-content"><div data-v-15189bc8="" data-v-48e13d92="" tabindex="0" class="md-chip md-theme-default md-clickable"><div class="md-ripple"><span data-v-15189bc8="" class=""> Node </span> </div> <!----></div><div data-v-15189bc8="" data-v-48e13d92="" tabindex="0" class="md-chip md-theme-default md-clickable"><div class="md-ripple"><span data-v-15189bc8="" class=""> JavaScript </span> </div> <!----></div></div><div data-v-48e13d92="" class="md-card-content"><div data-v-7fa946ff="" data-v-48e13d92="" class="comment"><div data-v-7fa946ff="" id="disqus_thread"><iframe id="dsq-app9334" name="dsq-app9334" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&amp;f=aquariuslt&amp;t_i=-posts-2016-03-06-site-code-structure&amp;t_u=https%3A%2F%2Fblog.aquariuslt.com%2Fposts%2F2016%2F03%2F06%2Fsite-code-structure&amp;t_d=Site%20%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E4%BB%8B%E7%BB%8D%20%7C%20Aquariuslt%20Blog&amp;t_t=Site%20%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E4%BB%8B%E7%BB%8D%20%7C%20Aquariuslt%20Blog&amp;s_o=default#version=049b9d4c8356e0d7fe6487ff57f30ea3" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 395px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div></div></div></div></div></div></div></div></main> <!----></div></div><script type="text/javascript" src="/js/chunk-vendors.6db92837.js"></script><script type="text/javascript" src="/js/app.35f821a8.js"></script><iframe style="display: none;"></iframe></body></html>